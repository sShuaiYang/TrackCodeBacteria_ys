function plotResult(resultCount,resultDivision,resultLength,resultDAevent)
windowSize=120;
averageNumberPoin=100;
plotTimeSeries(resultCount,averageNumberPoin,windowSize);
% splineAndPlotDivisionResult(resultDivision);
plotTimeLength(resultLength);
plotDAevent(resultDAevent);
end
function splineAndPlotDivisionResult(resultDivision)
distBin1=resultDivision{1}(:,1);
distData1=resultDivision{1}(:,2);
distData2=resultDivision{1}(:,3);
distData3=resultDivision{1}(:,4);
distData4=resultDivision{1}(:,5);
distData5=resultDivision{1}(:,6);
xx = 0:.5:max(distBin1);
splineData1 = spline(distBin1,distData1,xx);
splineData2 = spline(distBin1,distData2,xx);
splineData3 = spline(distBin1,distData3,xx);
splineData4 = spline(distBin1,distData4,xx);
splineData5 = spline(distBin1,distData5,xx);
creatSpatialCorrelationfigure(distBin1, distData1, xx, splineData1, distData2, splineData2, distData3, splineData3, distData4, splineData4, distData5, splineData5)
distBin1=resultDivision{2}(:,1);
distData1=resultDivision{2}(:,2);
distData2=resultDivision{2}(:,3);
distData3=resultDivision{2}(:,4);
distData4=resultDivision{2}(:,5);
distData5=resultDivision{2}(:,6);
xx = 0:.5:max(distBin1);
splineData1 = spline(distBin1,distData1,xx);
splineData2 = spline(distBin1,distData2,xx);
splineData3 = spline(distBin1,distData3,xx);
splineData4 = spline(distBin1,distData4,xx);
splineData5 = spline(distBin1,distData5,xx);
 createTimeCorrelationfigure(distBin1, distData1, xx, splineData1, distData2, splineData2, distData3, splineData3, distData4, splineData4, distData5, splineData5)
end
function plotTimeSeries(resultTime,averageNumberPoin,windowSize)
timeSeries=resultTime.Number(:,1);
traceNumber=resultTime.Number(:,2);
temp=resultTime.Number(1:windowSize:end,:);
tempPV=temp(temp(:,13)>=0,:);
tempNV=temp(temp(:,13)<0,:);
attechingNumber=resultTime.Number(:,3);
detchingNumber=resultTime.Number(:,6);
nodeType1Number=resultTime.Number(:,9);
nodeType2Number=resultTime.Number(:,10);
nodeType3Number=resultTime.Number(:,11);
errorattechingNumber=1./sqrt(attechingNumber);
errordetchingNumber=1./sqrt(detchingNumber);
errornodeType1Number=1./sqrt(nodeType1Number);
erroenodeType2Number=1./sqrt(nodeType2Number);
errornodeType3Number=1./sqrt(nodeType3Number);
averageRate=zeros(fix(size(resultTime.Rate,1)/averageNumberPoin),size(resultTime.Rate,2));
for iaverage=1:size(averageRate,1)
    averageRate(iaverage,1)=iaverage*averageNumberPoin;
    averageRate(iaverage,2)=mean(resultTime.Rate((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,2));
    averageRate(iaverage,3)=mean(resultTime.Rate((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,3));
    averageRate(iaverage,4)=mean(resultTime.Rate((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,4));
    averageRate(iaverage,5)=mean(resultTime.Rate((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,5));
    averageRate(iaverage,6)=mean(resultTime.Rate((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,6));
    if  averageRate(iaverage,2)~=0
        averageRate(iaverage,7)=(mean(errorattechingNumber((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,2))*0.5;
        averageRate(iaverage,8)=-(mean(errorattechingNumber((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,2))*0.5;
    else
        averageRate(iaverage,7)=0;
        averageRate(iaverage,8)=0;
    end
    if  averageRate(iaverage,3)~=0
        averageRate(iaverage,9)=(mean(errordetchingNumber((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,3))*0.5;
        averageRate(iaverage,10)=-(mean(errordetchingNumber((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,3))*0.5;
    else
        averageRate(iaverage,9)=0;
        averageRate(iaverage,10)=0;
    end
    if  averageRate(iaverage,4)~=0
        averageRate(iaverage,11)=(mean(errornodeType1Number((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,4))*0.5;
        averageRate(iaverage,12)=-(mean(errornodeType1Number((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,4))*0.5;
    else
        averageRate(iaverage,11)=0;
        averageRate(iaverage,12)=0;
    end
    if  averageRate(iaverage,5)~=0
        averageRate(iaverage,13)=(mean(erroenodeType2Number((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,5))*0.5;
        averageRate(iaverage,14)=-(mean(erroenodeType2Number((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,5))*0.5;
    else
        averageRate(iaverage,13)=0;
        averageRate(iaverage,14)=0;
    end
    if  averageRate(iaverage,6)~=0
        averageRate(iaverage,15)=(mean(errornodeType3Number((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,6))*0.5;
        averageRate(iaverage,16)=-(mean(errornodeType3Number((iaverage-1)*averageNumberPoin+1:iaverage*averageNumberPoin,1))*averageRate(iaverage,6))*0.5;
    else
        averageRate(iaverage,15)=0;
        averageRate(iaverage,16)=0;
    end
end
xx = 0:1:max(averageRate(:,1));
splineData(:,1) = spline(averageRate(:,1), averageRate(:,2),xx);
splineData(:,2) = spline(averageRate(:,1), averageRate(:,3),xx);
splineData(:,3) = spline(averageRate(:,1), averageRate(:,4),xx);
splineData(:,4) = spline(averageRate(:,1), averageRate(:,5),xx);
splineData(:,5) = spline(averageRate(:,1), averageRate(:,6),xx);
createNumberfigure(resultTime.Number(:,1), resultTime.Number(:,12));
createNumberDAfigure(tempNV(:,1), tempNV(:,13), tempPV(:,1), tempPV(:,13), temp(:,1), temp(:,11));
% createTimeSeriesfigure(averageRate(:,1), averageRate(:,2), averageRate(:,8), averageRate(:,7), xx, splineData(:,1), averageRate(:,3), averageRate(:,10), averageRate(:,9), splineData(:,2), averageRate(:,6), averageRate(:,16), averageRate(:,15), splineData(:,5))
createDAfigureALL(temp(:,1), temp(:,4), -temp(:,7), temp(:,4)-temp(:,7), temp(:,5), -temp(:,8), temp(:,5)-temp(:,8));
end
function createDAfigureALL(time1, a1, yvector1, a2, a3, yvector2, a4)
%CREATEFIGURE(TIME1,A1,YVECTOR1,A2,A3,YVECTOR2,A4)
%  TIME1:  bar xvector
%  A1:  bar yvector
%  YVECTOR1:  bar yvector
%  A2:  vector of y data
%  A3:  bar yvector
%  YVECTOR2:  bar yvector
%  A4:  vector of y data

%  Auto-generated by MATLAB on 14-Mar-2011 17:26:04

% Create figure
figure1 = figure;

% Create axes
axes1 = axes('Parent',figure1,'YGrid','on',...
    'XTickLabel',{'','','','','','','','','',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600 9800],...
    'XGrid','on',...
    'Position',[0.13 0.538567493112948 0.777074973600845 0.423932506887053],...
    'FontSize',14,...
    'Color',[1 0.949019610881805 0.866666674613953]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes1,[-120 9800]);
box(axes1,'on');
hold(axes1,'all');

% Create bar
bar(time1,a1,'FaceColor',[1 0 0],'Parent',axes1,'DisplayName','a0');

% Create bar
bar(time1,yvector1,'FaceColor',[0 1 0],'Parent',axes1,'DisplayName','-d0');

% Create plot
plot(time1,a2,'Parent',axes1,'LineWidth',3,'Color',[0 0 1],...
    'DisplayName','a0-d0');

% Create title
title('  Simple Event','FontSize',24);

% Create axes
axes2 = axes('Parent',figure1,'YTickLabel',{'-30','-10','10','30',''},...
    'YTick',[-30 -10 10 30 40],...
    'YGrid','on',...
    'XTickLabel',{'0','100','200','300','400','500','600','700','800',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600 9800],...
    'XGrid','on',...
    'Position',[0.13 0.0949449035812672 0.777074973600845 0.422961432506887],...
    'FontSize',14,...
    'Color',[0.894117653369904 0.941176474094391 0.901960790157318]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes2,[-120 9800]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes2,[-30 40]);
box(axes2,'on');
hold(axes2,'all');

% Create title
title('  Others Event','FontSize',24);

% Create xlabel
xlabel('Time [Min]','FontSize',16);

% Create ylabel
ylabel('Number of Event','FontSize',16);

% Create bar
bar(time1,a3,'FaceColor',[1 0 0],'Parent',axes2,'DisplayName','Attaching');

% Create bar
bar(time1,yvector2,'FaceColor',[0 1 0],'Parent',axes2,...
    'DisplayName','Detaching');

% Create plot
plot(time1,a4,'Parent',axes2,'LineWidth',2,'Color',[0 0 1],...
    'DisplayName','A-D');

% Create legend
legend1 = legend(axes2,'show');
set(legend1,...
    'Position',[0.67458641323477 0.840449954086318 0.151003167898627 0.108356290174472]);
end


function plotTimeLength(resultLength)
avergeLength=resultLength.averageLength;
hist2Dlength=resultLength.hist2D;
divisionLength=resultLength.divisionLength;
xx=min(avergeLength(:,1)):(max(avergeLength(:,1))-min(avergeLength(:,1)))/500:max(avergeLength(:,1));
splineaverageLength = spline(avergeLength(:,1),avergeLength(:,2),xx);
splineBeforeDivisionLength = spline(divisionLength(:,1),divisionLength(:,2),xx);
splineAfterDivisionLength = spline(divisionLength(:,1),divisionLength(:,3),xx);
createLengthfigure(hist2Dlength, 1:size(hist2Dlength,1), 1:size(hist2Dlength,2), hist2Dlength, avergeLength(:,2),divisionLength(:,1),divisionLength(:,2:3),xx, [splineBeforeDivisionLength',splineaverageLength',splineAfterDivisionLength']);
end
function plotDAevent(resultDAevent)
% minLength=0;
% stepLength=1;
% maxLength=70;
% atachingHist=resultDAevent.length.attaching;
% detachingHist=resultDAevent.length.detaching;
% attachingLengthTime=zeros(1,size(atachingHist,2));
% detachingLengthTime=zeros(1,size(atachingHist,2));
% legthBin=minLength:stepLength:maxLength-stepLength;
% % for iTime=1:size(atachingHist,2)
% attachingLengthTime(iTime)=sum((atachingHist(:,iTime)./(sum(atachingHist(:,iTime)))).*legthBin');
% detachingLengthTime(iTime)=sum((detachingHist(:,iTime)./(sum(detachingHist(:,iTime)))).*legthBin');
% end
% xx1=1:(size(atachingHist,2)-1)/300:size(atachingHist,2);
% splineAttaqchingLengthTime=spline(1:size(atachingHist,2),attachingLengthTime,xx1);
% splineDetachingLengthTime=spline(1:size(atachingHist,2),detachingLengthTime,xx1);
% attachingLengthHist=mean(atachingHist');
% detachingLengthHist=mean(detachingHist');
% attachingLengthHist=[0,(attachingLengthHist(1:end-1)+attachingLengthHist(2:end))./2,];
% detachingLengthHist=[0,(detachingLengthHist(1:end-1)+detachingLengthHist(2:end))./2,];
% selectAttachingLength=zeros(1,size(attachingLengthHist,2));
% for i=1:size(attachingLengthHist,2)
%     if detachingLengthHist(i)>0
%         selectAttachingLength(i)=attachingLengthHist(i)/detachingLengthHist(i);
%     end
% end
% xx2=1:(size(atachingHist,1)-1)/300:size(atachingHist,1);
% splineAttaqchingLengthHist=spline(1:size(atachingHist,1),attachingLengthHist,xx2);
% splineDetachingLengthHist=spline(1:size(atachingHist,1),detachingLengthHist,xx2);
% splineSelectLengthHist=spline(1:size(atachingHist,1),selectAttachingLength,xx2);
% createDAfigure(detachingHist, 1:size(atachingHist,1), 1:size(atachingHist,2), detachingHist, detachingLengthHist, 1:size(atachingHist,1), splineDetachingLengthHist, xx2, detachingLengthTime, xx1, splineDetachingLengthTime);
% createDAfigure(atachingHist, 1:size(atachingHist,1), 1:size(atachingHist,2), atachingHist, attachingLengthHist, 1:size(atachingHist,1), splineAttaqchingLengthHist, xx2, attachingLengthTime, xx1, splineAttaqchingLengthTime);
% createSelcetAttachingfigure([detachingLengthHist',attachingLengthHist',selectAttachingLength'], xx2, [splineDetachingLengthHist',splineAttaqchingLengthHist',splineSelectLengthHist']);
% createDurationfigure(resultDAevent.duration.count(:,1), resultDAevent.duration.count(:,2), resultDAevent.duration.length(:,2));
% plotCorrelationResult(resultDAevent.spaceCorrelation.attaching,resultDAevent.timeCorrelation.attaching);
% plotCorrelationResult(resultDAevent.spaceCorrelation.detaching,resultDAevent.timeCorrelation.detaching);
createSurriveTimefigure(resultDAevent.type0.attachingSurrive(:,1), [resultDAevent.type0.attachingSurrive(:,2),resultDAevent.type0.detachingSurrive(:,2),resultDAevent.type1.attachingSurrive(:,2),resultDAevent.type1.detachingSurrive(:,2)]);
end
function createNumberfigure(resultCount1, resultCount2)
%CREATEFIGURE(RESULTCOUNT1,RESULTCOUNT2)
%  RESULTCOUNT1:  vector of x data
%  RESULTCOUNT2:  vector of y data

%  Auto-generated by MATLAB on 01-Mar-2011 22:45:07

% Create figure
figure1 = figure;

% Create axes
axes1 = axes('Parent',figure1,'YScale','log','YMinorTick','on',...
    'YMinorGrid','on',...
    'YGrid','on',...
    'XTickLabel',{'','','','','','','','',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600],...
    'XGrid','on',...
    'Position',[0.13 0.510791366906475 0.774 0.399280575539568],...
    'FontSize',14,...
    'Color',[0.839215695858002 0.909803926944733 0.850980401039124]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes1,[0 9600]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes1,[10 300]);
box(axes1,'on');
hold(axes1,'all');

% Create ylabel
ylabel('Surface Number','FontSize',16);

% Create semilogy
semilogy(resultCount1,resultCount2,'Parent',axes1,'MarkerSize',0.5,...
    'Marker','o',...
    'LineWidth',2,...
    'Color',[1 0 0],...
    'DisplayName','resultCount.Number(:,8) vs resultCount.Number(:,1)');

% Create axes
axes2 = axes('Parent',figure1,'YTickLabel',{'0','50','100','150',''},...
    'YGrid','on',...
    'XTickLabel',{'0','100','200','300','400','500','600','700','800'},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600],...
    'XGrid','on',...
    'Position',[0.1284 0.101762589928058 0.775 0.4075],...
    'FontSize',14,...
    'Color',[0.839215695858002 0.909803926944733 0.850980401039124]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes2,[0 9600]);
box(axes2,'on');
hold(axes2,'all');

% Create plot
plot(resultCount1,resultCount2,'Parent',axes2,...
    'DisplayName','resultCount.Number(:,8) vs resultCount.Number(:,1)');

% Create title
title('Time [min]','FontSize',16);
end
function createNumberDAfigure(xvector1, yvector1, xvector2, yvector2, X1, Y1)
%CREATEFIGURE(XVECTOR1,YVECTOR1,XVECTOR2,YVECTOR2,X1,Y1)
%  XVECTOR1:  bar xvector
%  YVECTOR1:  bar yvector
%  XVECTOR2:  bar xvector
%  YVECTOR2:  bar yvector
%  X1:  stem x
%  Y1:  stem y

%  Auto-generated by MATLAB on 02-Mar-2011 13:04:28

% Create figure
figure1 = figure;

% Create axes
axes1 = axes('Parent',figure1,'YTick',[-20 -10 0 10 20 30],'YGrid','on',...
    'XTickLabel',{'0','100','200','300','400','500','600','700','800',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600 9900],...
    'XGrid','on',...
    'Position',[0.134054378849332 0.140597539543058 0.783926693705873 0.784887634147252],...
    'FontSize',16,...
    'Color',[1 0.949019610881805 0.866666674613953]);
% Uncomment the following line to preserve the X-limits of the axes
% xlim(axes1,[0 10000]);
box(axes1,'on');
hold(axes1,'all');

% Create bar
bar(xvector1,yvector1,'FaceColor',[1 0 0],'BarLayout','stacked',...
    'Parent',axes1,...
    'DisplayName','A-D < 0');

% Create bar
bar(xvector2,yvector2,'FaceColor',[0 1 0],'BarLayout','stacked',...
    'Parent',axes1,...
    'DisplayName','A-D > 0');

% Create stem
stem(X1,Y1,'LineWidth',1,...
    'Color',[0.47843137383461 0.062745101749897 0.894117653369904],...
    'Parent',axes1,...
    'DisplayName','Division');

% Create xlabel
xlabel('Time [Min]','FontSize',16);

% Create ylabel
ylabel('Number','FontSize',16);

% Create legend
legend1 = legend(axes1,'show');
set(legend1,'EdgeColor',[1 0.949019610881805 0.866666674613953],...
    'YColor',[1 0.949019610881805 0.866666674613953],...
    'XColor',[1 0.949019610881805 0.866666674613953],...
    'Position',[0.225289169295478 0.742237844224103 0.312565720294427 0.155828939607178]);


end
function creatSpatialCorrelationfigure(X1, Y1, X2, Y2, Y3, Y4, Y5, Y6, Y7, Y8, Y9, Y10)
%CREATEFIGURE(X1,Y1,X2,Y2,Y3,Y4,Y5,Y6,Y7,Y8,Y9,Y10)
%  X1:  vector of x data
%  Y1:  vector of y data
%  X2:  vector of x data
%  Y2:  vector of y data
%  Y3:  vector of y data
%  Y4:  vector of y data
%  Y5:  vector of y data
%  Y6:  vector of y data
%  Y7:  vector of y data
%  Y8:  vector of y data
%  Y9:  vector of y data
%  Y10:  vector of y data

%  Auto-generated by MATLAB on 19-Oct-2010 17:24:46

% Create figure
figure1 = figure;

% Create axes
axes1 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.128461538461539 0.749852044881879 0.776009244992296 0.120457680586002],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes1,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes1,[-2e-009 2e-008]);
box(axes1,'on');
hold(axes1,'all');

% Create title
title('Spatial  Correlation in diffrent Time Scale','FontSize',20,...
    'FontName','Times New Roman');

% Create plot
plot(X1,Y1,'Parent',axes1,...
    'MarkerFaceColor',[0.83921568627451 0.909803921568627 0.850980392156863],...
    'MarkerEdgeColor',[1 0 0],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData1 vs distBin');

% Create plot
plot(X2,Y2,'Parent',axes1,'LineWidth',2,...
    'Color',[0.854901969432831 0.701960802078247 1],...
    'DisplayName','splineData1 vs xx');

% Create axes
axes2 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.128194392164494 0.630211563041336 0.77657935285054 0.116719242902205],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes2,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes2,[-2e-009 2e-008]);
box(axes2,'on');
hold(axes2,'all');

% Create ylabel
ylabel('Corrleation','FontSize',24,'FontName','Times New Roman');

% Create plot
plot(X1,Y3,'Parent',axes2,...
    'MarkerFaceColor',[0.67843137254902 0.92156862745098 1],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData2 vs distBin');

% Create plot
plot(X2,Y4,'Parent',axes2,'LineWidth',2,...
    'Color',[0.749019622802734 0.749019622802734 0],...
    'DisplayName','splineData2 vs xx');

% Create axes
axes3 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.129508658880387 0.50743555230117 0.77818364881192 0.118993926733138],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes3,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes3,[-2e-009 2e-008]);
box(axes3,'on');
hold(axes3,'all');

% Create plot
plot(X1,Y5,'Parent',axes3,...
    'MarkerFaceColor',[0.925490196078431 0.83921568627451 0.83921568627451],...
    'MarkerEdgeColor',[0.600000023841858 0.200000002980232 0],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData3 vs distBin');

% Create plot
plot(X2,Y6,'Parent',axes3,'MarkerSize',8,'LineWidth',2,'Color',[0 0 1],...
    'DisplayName','splineData3 vs xx');

% Create axes
axes4 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.128461538461539 0.386862630026062 0.777692307692307 0.117584638080672],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes4,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes4,[-2e-009 2e-008]);
box(axes4,'on');
hold(axes4,'all');

% Create plot
plot(X1,Y7,'Parent',axes4,...
    'MarkerFaceColor',[0.992156862745098 0.917647058823529 0.796078431372549],...
    'MarkerEdgeColor',[0.600000023841858 0.200000002980232 0],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData4 vs distBin');

% Create plot
plot(X2,Y8,'Parent',axes4,...
    'MarkerEdgeColor',[0.47843137383461 0.062745101749897 0.894117653369904],...
    'MarkerSize',8,...
    'LineWidth',2,...
    'Color',[1 0 0],...
    'DisplayName','splineData4 vs xx');

% Create axes
axes5 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'0','20','40','60','80','100',''},...
    'XGrid','on',...
    'Position',[0.128461538461538 0.261753494282084 0.779230769230769 0.121982210927573],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes5,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes5,[-2e-009 2e-008]);
box(axes5,'on');
hold(axes5,'all');

% Create xlabel
xlabel('\Delta r [pixels]','FontSize',24,'FontName','Times New Roman');

% Create plot
plot(X1,Y9,'Parent',axes5,...
    'MarkerFaceColor',[0.756862745098039 0.866666666666667 0.776470588235294],...
    'MarkerEdgeColor',[0.749019622802734 0 0.749019622802734],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData5 vs distBin');

% Create plot
plot(X2,Y10,'Parent',axes5,'LineWidth',2,'DisplayName','splineData5 vs xx');

% Create textbox
annotation(figure1,'textbox',...
    [0.730769230769231 0.671503176620082 0.178461538461538 0.0444726810673443],...
    'String',{' \Deltat = 16min'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.732307692307692 0.551121982210939 0.178461538461538 0.0444726810673443],...
    'String',{' \Deltat = 64min'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.73076923076923 0.429139771283373 0.192307692307692 0.0444726810673443],...
    'String',{' \Deltat = 128min'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.733846153846154 0.30588691232531 0.192307692307692 0.0444726810673443],...
    'String',{' \Deltat = 256min'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.732307692307692 0.796966963151209 0.518461538461538 0.0419313850063532],...
    'String',{' \Deltat = 4min'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');
end
function createTimeCorrelationfigure(X1, Y1, X2, Y2, Y3, Y4, Y5, Y6, Y7, Y8, Y9, Y10)
%CREATEFIGURE(X1,Y1,X2,Y2,Y3,Y4,Y5,Y6,Y7,Y8,Y9,Y10)
%  X1:  vector of x data
%  Y1:  vector of y data
%  X2:  vector of x data
%  Y2:  vector of y data
%  Y3:  vector of y data
%  Y4:  vector of y data
%  Y5:  vector of y data
%  Y6:  vector of y data
%  Y7:  vector of y data
%  Y8:  vector of y data
%  Y9:  vector of y data
%  Y10:  vector of y data

%  Auto-generated by MATLAB on 19-Oct-2010 17:23:43

% Create figure
figure1 = figure('Color',...
    [0.933333337306976 0.933333337306976 0.933333337306976]);

% Create axes
axes1 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.128461538461539 0.749852044881879 0.776009244992296 0.120457680586002],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes1,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes1,[-4e-009 4e-008]);
box(axes1,'on');
hold(axes1,'all');

% Create title
title('Time  Correlation in diffrent length Scale','FontSize',20,...
    'FontName','Times New Roman');

% Create plot
plot(X1,Y1,'Parent',axes1,...
    'MarkerFaceColor',[0.83921568627451 0.909803921568627 0.850980392156863],...
    'MarkerEdgeColor',[1 0 0],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData1 vs distBin');

% Create plot
plot(X2,Y2,'Parent',axes1,'LineWidth',2,...
    'Color',[0.854901969432831 0.701960802078247 1],...
    'DisplayName','splineData1 vs xx');

% Create axes
axes2 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.128194392164494 0.630221001522496 0.77657935285054 0.116719242902205],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes2,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes2,[-4e-009 4e-008]);
box(axes2,'on');
hold(axes2,'all');

% Create ylabel
ylabel('Corrleation','FontSize',24,'FontName','Times New Roman');

% Create plot
plot(X1,Y3,'Parent',axes2,...
    'MarkerFaceColor',[0.67843137254902 0.92156862745098 1],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData2 vs distBin');

% Create plot
plot(X2,Y4,'Parent',axes2,'LineWidth',2,...
    'Color',[0.749019622802734 0.749019622802734 0],...
    'DisplayName','splineData2 vs xx');

% Create axes
axes3 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.129508658880387 0.50743555230117 0.77818364881192 0.118993926733138],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes3,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes3,[-4e-009 4e-008]);
box(axes3,'on');
hold(axes3,'all');

% Create plot
plot(X1,Y5,'Parent',axes3,...
    'MarkerFaceColor',[0.925490196078431 0.83921568627451 0.83921568627451],...
    'MarkerEdgeColor',[0.600000023841858 0.200000002980232 0],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData3 vs distBin');

% Create plot
plot(X2,Y6,'Parent',axes3,'MarkerSize',8,'LineWidth',2,'Color',[0 0 1],...
    'DisplayName','splineData3 vs xx');

% Create axes
axes4 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'','','','','','',''},...
    'XGrid','on',...
    'Position',[0.128461538461539 0.386862630026062 0.777692307692307 0.117584638080672],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes4,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes4,[-4e-009 4e-008]);
box(axes4,'on');
hold(axes4,'all');

% Create plot
plot(X1,Y7,'Parent',axes4,...
    'MarkerFaceColor',[0.992156862745098 0.917647058823529 0.796078431372549],...
    'MarkerEdgeColor',[0.600000023841858 0.200000002980232 0],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData4 vs distBin');

% Create plot
plot(X2,Y8,'Parent',axes4,...
    'MarkerEdgeColor',[0.47843137383461 0.062745101749897 0.894117653369904],...
    'MarkerSize',8,...
    'LineWidth',2,...
    'Color',[1 0 0],...
    'DisplayName','splineData4 vs xx');

% Create axes
axes5 = axes('Parent',figure1,'YTickLabel',{'0','0.1',''},...
    'XTickLabel',{'0','1.7','3.4','5.1','6.8','8.5',''},...
    'XGrid','on',...
    'Position',[0.128461538461538 0.261753494282084 0.779230769230769 0.121982210927573],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes5,[0 120]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes5,[-4e-009 4e-008]);
box(axes5,'on');
hold(axes5,'all');

% Create xlabel
xlabel('\Delta t [min]','FontSize',24,'FontName','Times New Roman');

% Create plot
plot(X1,Y9,'Parent',axes5,...
    'MarkerFaceColor',[0.756862745098039 0.866666666666667 0.776470588235294],...
    'MarkerEdgeColor',[0.749019622802734 0 0.749019622802734],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','distData5 vs distBin');

% Create plot
plot(X2,Y10,'Parent',axes5,'LineWidth',2,'DisplayName','splineData5 vs xx');

% Create textbox
annotation(figure1,'textbox',...
    [0.727706465313827 0.796966963151209 0.518461538461538 0.0419313850063532],...
    'String',{' \Deltar = 50 p'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.729235488437943 0.671503176620082 0.178461538461538 0.0444726810673443],...
    'String',{' \Deltar = 128 p'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.730773949976404 0.551121982210939 0.178461538461538 0.0444726810673443],...
    'String',{' \Deltar = 256 p'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.729235488437942 0.429139771283373 0.192307692307692 0.0444726810673443],...
    'String',{' \Deltar = 512 p'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.729244926852289 0.30588691232531 0.192307692307692 0.0444726810673443],...
    'String',{' \Deltat = 1024p'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');
end
function createTimeSeriesfigure(X1, Y1, L1, U1, X2, Y2, Y3, L2, U2, Y4, Y5, L3, U3, Y6)
%CREATEFIGURE(X1,Y1,L1,U1,X2,Y2,Y3,L2,U2,Y4,Y5,L3,U3,Y6)
%  X1:  errorbar x
%  Y1:  errorbar y
%  L1:  errorbar l
%  U1:  errorbar u
%  X2:  vector of x data
%  Y2:  vector of y data
%  Y3:  errorbar y
%  L2:  errorbar l
%  U2:  errorbar u
%  Y4:  vector of y data
%  Y5:  errorbar y
%  L3:  errorbar l
%  U3:  errorbar u
%  Y6:  vector of y data

%  Auto-generated by MATLAB on 19-Oct-2010 21:06:13

% Create figure
figure1 = figure;

% Create axes
axes1 = axes('Parent',figure1,'YTickLabel',{'0','0.012','0.024',''},...
    'XTickLabel',{'','','','','','','','','','',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600 10800 11000],...
    'XGrid','on',...
    'Position',[0.227398589538098 0.65444287729196 0.565805036778943 0.249647390691114],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes1,[0 11000]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes1,[0 0.003]);
box(axes1,'on');
hold(axes1,'all');

% Create errorbar
errorbar(X1,Y1,L1,U1,'MarkerSize',8,...
    'MarkerFaceColor',[0.925490196078431 0.83921568627451 0.83921568627451],...
    'MarkerEdgeColor',[0.450980392156863 0.262745098039216 0.262745098039216],...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','averageRate(:,2) vs averageRate(:,1)',...
    'Color',[0 0.749019622802734 0.749019622802734],...
    'Parent',axes1);

% Create plot
plot(X2,Y2,'Parent',axes1,'LineWidth',2,...
    'Color',[0.847058832645416 0.160784319043159 0],...
    'DisplayName','splineData(:,1) vs xx');

% Create axes
axes2 = axes('Parent',figure1,'YTickLabel',{'0','0.012','0.024',''},...
    'XTickLabel',{'','','','','','','','','','',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600 10800 11000],...
    'XGrid','on',...
    'Position',[0.22709837971636 0.40197461212976 0.567372774129794 0.246826516220028],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes2,[0 11000]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes2,[0 0.003]);
box(axes2,'on');
hold(axes2,'all');

% Create ylabel
ylabel('Probability [/min]','FontSize',24,'FontName','Times New Roman');

% Create errorbar
errorbar(X1,Y3,L2,U2,'MarkerSize',8,...
    'MarkerFaceColor',[0.937254901960784 0.866666666666667 0.866666666666667],...
    'MarkerEdgeColor',[0.168627455830574 0.505882382392883 0.337254911661148],...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','averageRate(:,3) vs averageRate(:,1)',...
    'Color',[0 0 1],...
    'Parent',axes2);

% Create plot
plot(X2,Y4,'Parent',axes2,'LineWidth',2,'Color',[0 0.498039215803146 0],...
    'DisplayName','splineData(:,2) vs xx');

% Create axes
axes3 = axes('Parent',figure1,'YTickLabel',{'0','0.006'},'YTick',[0 0.0005],...
    'XTickLabel',{'0','100','200','300','400','500','600','700','800','900',''},...
    'XTick',[0 1200 2400 3600 4800 6000 7200 8400 9600 10800 11000],...
    'XGrid','on',...
    'Position',[0.229758531594645 0.142454160789845 0.564319206492336 0.2524682651622],...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.87058824300766 0.921568632125854 0.980392158031464]);
% Uncomment the following line to preserve the X-limits of the axes
 xlim(axes3,[0 11000]);
% Uncomment the following line to preserve the Y-limits of the axes
 ylim(axes3,[-0.0001 0.001]);
box(axes3,'on');
hold(axes3,'all');

% Create xlabel
xlabel('Time [min]','FontSize',24,'FontName','Times New Roman');

% Create errorbar
errorbar(X1,Y5,L3,U3,'MarkerSize',8,...
    'MarkerFaceColor',[0.756862745098039 0.866666666666667 0.776470588235294],...
    'MarkerEdgeColor',[0.682352960109711 0.466666668653488 0],...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','averageRate(:,6) vs averageRate(:,1)',...
    'Color',[0 0 1],...
    'Parent',axes3);

% Create plot
plot(X2,Y6,'Parent',axes3,'LineWidth',2,'Color',[1 1 0],...
    'DisplayName','splineData(:,5) vs xx');

% Create textbox
annotation(figure1,'textbox',...
    [0.653645627030026 0.433272802411312 0.139423076923077 0.0479548660084626],...
    'String',{'Detaching'},...
    'FontSize',14,...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.657167769151548 0.694981939824085 0.131009615384615 0.0479548660084626],...
    'String',{'Attaching'},...
    'FontSize',14,...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.652964677572685 0.239677009873061 0.116586538461538 0.0479548660084626],...
    'String',{'Division'},...
    'FontSize',14,...
    'FitBoxToText','off',...
    'LineStyle','none');
end
function createLengthfigure(ZData1, YData1, XData1, CData1, avergeLength1, divisionLength1, YMatrix1, xx1, YMatrix2)
%CREATEFIGURE(ZDATA1,YDATA1,XDATA1,CDATA1,AVERGELENGTH1,DIVISIONLENGTH1,YMATRIX1,XX1,YMATRIX2)
%  ZDATA1:  surface zdata
%  YDATA1:  surface ydata
%  XDATA1:  surface xdata
%  CDATA1:  surface cdata
%  AVERGELENGTH1:  vector of y data
%  DIVISIONLENGTH1:  vector of x data
%  YMATRIX1:  matrix of y data
%  XX1:  vector of x data
%  YMATRIX2:  matrix of y data

%  Auto-generated by MATLAB on 21-Oct-2010 22:40:45

% Create figure
figure1 = figure('Colormap',...
    [1 1 1;1 0.98412698507309 1;1 0.968253970146179 1;1 0.952380955219269 1;1 0.936507940292358 1;1 0.920634925365448 1;1 0.904761910438538 1;1 0.888888895511627 1;1 0.873015880584717 1;1 0.857142865657806 1;1 0.841269850730896 1;1 0.825396835803986 1;1 0.809523820877075 1;1 0.793650805950165 1;1 0.777777791023254 1;1 0.761904776096344 1;1 0.746031761169434 1;1 0.730158746242523 1;1 0.714285731315613 1;1 0.698412716388702 1;1 0.682539701461792 1;1 0.666666686534882 1;1 0.650793671607971 1;1 0.634920656681061 1;1 0.61904764175415 1;1 0.60317462682724 1;1 0.58730161190033 1;1 0.571428596973419 1;1 0.555555582046509 1;1 0.539682567119598 1;1 0.523809552192688 1;1 0.507936537265778 1;1 0.492063492536545 1;1 0.476190477609634 1;1 0.460317462682724 1;1 0.444444447755814 1;1 0.428571432828903 1;1 0.412698417901993 1;1 0.396825402975082 1;1 0.380952388048172 1;1 0.365079373121262 1;1 0.349206358194351 1;1 0.333333343267441 1;1 0.31746032834053 1;1 0.30158731341362 1;1 0.28571429848671 1;1 0.269841283559799 1;1 0.253968268632889 1;1 0.238095238804817 1;1 0.222222223877907 1;1 0.206349208950996 1;1 0.190476194024086 1;1 0.174603179097176 1;1 0.158730164170265 1;1 0.142857149243355 1;1 0.126984134316444 1;1 0.111111111938953 1;1 0.095238097012043 1;1 0.0793650820851326 1;1 0.0634920671582222 1;1 0.0476190485060215 1;1 0.0317460335791111 1;1 0.0158730167895556 1;1 0 1]);

% Create axes
axes1 = axes('Parent',figure1,...
    'YTickLabel',{'10','20','30','40','50','60',''},...
    'XTickLabel',{'0','100','200','300','400','500','600','700','800','900',''},...
    'XTick',[1 4.2 7.4 10.6 13.8 17 20.2 23.4 26.6 29.8 33],...
    'Position',[0.13 0.129205921938089 0.677185628742515 0.795794078061911],...
    'LineWidth',2,...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'CLim',[0 0.385]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes1,[1 33]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes1,[1 71]);
box(axes1,'on');
hold(axes1,'all');

% Create xlabel
xlabel('Time [min]','FontSize',24,'FontName','Times New Roman');

% Create ylabel
ylabel('Length [pixels]','FontSize',24,'FontName','Times New Roman');

% Create surface
surface('Parent',axes1,'ZData',ZData1,'YData',YData1,'XData',XData1,...
    'LineStyle','none',...
    'CData',CData1);

% Create plot
plot(XData1,avergeLength1,'Parent',axes1,...
    'MarkerFaceColor',[0.729411780834198 0.831372559070587 0.95686274766922],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','avergeLength(:,2) vs avergeLength(:,1)');

% Create multiple lines using matrix input to plot
plot1 = plot(divisionLength1,YMatrix1,'Parent',axes1,'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none');
set(plot1(1),...
    'MarkerFaceColor',[0.756862759590149 0.866666674613953 0.776470601558685],...
    'DisplayName','divisionLength(:,2) vs divisionLength(:,1)');
set(plot1(2),...
    'MarkerFaceColor',[0.937254905700684 0.866666674613953 0.866666674613953],...
    'DisplayName','divisionLength(:,3) vs divisionLength(:,1)');

% Create multiple lines using matrix input to plot
plot2 = plot(xx1,YMatrix2,'Parent',axes1,'LineWidth',2);
set(plot2(1),'DisplayName','splineaverageLength vs xx');
set(plot2(2),'DisplayName','splineAfterDivisionLength vs xx');
set(plot2(3),'DisplayName','splineBeforeDivisionLength vs xx');

% Create colorbar
colorbar('peer',axes1,'FontSize',14,'FontName','Times New Roman');
% Resize the axes in order to prevent it from shrinking.
set(axes1,...
    'Position',[0.13 0.129205921938089 0.677185628742515 0.795794078061911]);

% Create textbox
annotation(figure1,'textbox',...
    [0.80651945320715 0.927667563930014 0.138922155688623 0.044414535666218],...
    'String',{'Distribution'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.167864901112601 0.252028263795425 0.159281437125748 0.044414535666218],...
    'String',{'After Division'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.144058885383806 0.697519515477793 0.173652694610778 0.044414535666218],...
    'String',{'Before Division'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.71223231769898 0.561584118438762 0.107784431137725 0.044414535666218],...
    'String',{'Average'},...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'LineStyle','none');

end
function createDAfigure(ZData1, YData1, XData1, CData1, detachingLengthHist1, Y1, splineDetachingLengthHist1, xx1, detachingLengthTime1, xx2, splineDetachingLengthTime1)
%CREATEFIGURE(ZDATA1,YDATA1,XDATA1,CDATA1,DETACHINGLENGTHHIST1,Y1,SPLINEDETACHINGLENGTHHIST1,XX1,DETACHINGLENGTHTIME1,XX2,SPLINEDETACHINGLENGTHTIME1)
%  ZDATA1:  surface zdata
%  YDATA1:  surface ydata
%  XDATA1:  surface xdata
%  CDATA1:  surface cdata
%  DETACHINGLENGTHHIST1:  vector of x data
%  Y1:  vector of y data
%  SPLINEDETACHINGLENGTHHIST1:  vector of x data
%  XX1:  vector of y data
%  DETACHINGLENGTHTIME1:  vector of y data
%  XX2:  vector of x data
%  SPLINEDETACHINGLENGTHTIME1:  vector of y data

%  Auto-generated by MATLAB on 23-Oct-2010 18:49:11

% Create figure
figure1 = figure('Colormap',...
    [0.894117653369904 0.941176474094391 0.901960790157318;0.887519478797913 0.927233099937439 0.901836276054382;0.880921244621277 0.913289785385132 0.901711821556091;0.874323070049286 0.89934641122818 0.901587307453156;0.867724895477295 0.885403037071228 0.90146279335022;0.861126661300659 0.871459722518921 0.901338338851929;0.854528486728668 0.857516348361969 0.901213824748993;0.847930312156677 0.843572974205017 0.901089310646057;0.841332077980042 0.82962965965271 0.900964856147766;0.834733903408051 0.815686285495758 0.90084034204483;0.82813572883606 0.801742911338806 0.900715827941895;0.821537494659424 0.787799596786499 0.900591373443604;0.814939320087433 0.773856222629547 0.900466859340668;0.808341145515442 0.759912848472595 0.900342345237732;0.801742911338806 0.745969474315643 0.900217890739441;0.795144736766815 0.732026159763336 0.900093376636505;0.788546562194824 0.718082785606384 0.899968862533569;0.781948328018188 0.704139411449432 0.899844408035278;0.775350153446198 0.690196096897125 0.899719893932343;0.768751978874207 0.676252722740173 0.899595379829407;0.762153744697571 0.662309348583221 0.899470925331116;0.75555557012558 0.648366034030914 0.89934641122818;0.748957335948944 0.634422659873962 0.899221897125244;0.742359161376953 0.620479285717011 0.899097442626953;0.735760986804962 0.606535971164703 0.898972928524017;0.729162752628326 0.592592597007751 0.898848414421082;0.722564578056335 0.5786492228508 0.898723959922791;0.715966403484344 0.564705908298492 0.898599445819855;0.709368169307709 0.550762534141541 0.898474931716919;0.702769994735718 0.536819159984589 0.898350477218628;0.696171820163727 0.522875845432281 0.898225963115692;0.689573585987091 0.50893247127533 0.898101449012756;0.6829754114151 0.494989097118378 0.897976994514465;0.676377236843109 0.481045752763748 0.89785248041153;0.669779002666473 0.467102408409119 0.897727966308594;0.663180828094482 0.453159034252167 0.897603511810303;0.656582653522491 0.439215689897537 0.897478997707367;0.649984419345856 0.425272345542908 0.897354483604431;0.643386244773865 0.411328971385956 0.89723002910614;0.636788070201874 0.397385627031326 0.897105515003204;0.630189836025238 0.383442282676697 0.896981000900269;0.623591661453247 0.369498908519745 0.896856546401978;0.616993486881256 0.355555564165115 0.896732032299042;0.61039525270462 0.341612190008163 0.896607518196106;0.603797078132629 0.327668845653534 0.896483063697815;0.597198903560638 0.313725501298904 0.896358549594879;0.590600669384003 0.299782127141953 0.896234035491943;0.584002494812012 0.285838782787323 0.896109580993652;0.577404320240021 0.271895438432693 0.895985066890717;0.570806086063385 0.257952064275742 0.895860552787781;0.564207911491394 0.244008719921112 0.89573609828949;0.557609736919403 0.230065360665321 0.895611584186554;0.551011502742767 0.216122001409531 0.895487070083618;0.544413328170776 0.202178657054901 0.895362615585327;0.537815153598785 0.18823529779911 0.895238101482391;0.53121691942215 0.17429193854332 0.895113587379456;0.524618744850159 0.16034859418869 0.894989132881165;0.518020570278168 0.146405234932899 0.894864618778229;0.511422336101532 0.132461875677109 0.894740104675293;0.504824161529541 0.118518523871899 0.894615650177002;0.498225957155228 0.104575164616108 0.894491136074066;0.491627752780914 0.0906318128108978 0.89436662197113;0.485029578208923 0.0766884535551071 0.894242167472839;0.47843137383461 0.062745101749897 0.894117653369904],...
    'Color',[1 1 1]);

% Create axes
axes1 = axes('Parent',figure1,...
    'YTickLabel',{'0','10','20','30','40','50','60',''},...
    'YTick',[1 11 21 31 41 51 61 70],...
    'XTickLabel',{'150','300','450','600','750','900'},...
    'Position',[0.0965226781857457 0.165149544863459 0.584902807775377 0.508875162548765],...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'CLim',[0 1]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes1,[1 33]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes1,[1 70]);
box(axes1,'on');
hold(axes1,'all');

% Create xlabel
xlabel('Time [min]','FontSize',24,'FontName','Times New Roman');

% Create ylabel
ylabel('Length [pixels]','FontSize',24,'FontName','Times New Roman');

% Create surface
surface('Parent',axes1,'ZData',ZData1,'YData',YData1,'XData',XData1,...
    'LineStyle','none',...
    'FaceColor','interp',...
    'CData',CData1);

% Create axes
axes2 = axes('Parent',figure1,'YTickLabel',{'','','','','','','',''},...
    'YGrid','on',...
    'XGrid','on',...
    'Position',[0.700213948101544 0.165149544863459 0.165876764641436 0.509752925877763],...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'Color',[0.894117653369904 0.941176474094391 0.901960790157318]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes2,[0 0.8]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes2,[1 70]);
box(axes2,'on');
hold(axes2,'all');

% Create plot
plot(detachingLengthHist1,Y1,'Parent',axes2,...
    'MarkerFaceColor',[1 0.600000023841858 0.7843137383461],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'Color',[0 0 1],...
    'DisplayName','1:size(detachingLengthHist,2) vs detachingLengthHist');

% Create plot
plot(splineDetachingLengthHist1,xx1,'Parent',axes2,...
    'MarkerFaceColor',[0.925490196078431 0.83921568627451 0.83921568627451],...
    'LineWidth',2,...
    'Color',[0.450980395078659 0.26274511218071 0.26274511218071],...
    'DisplayName','xx2 vs splineDetachingLengthHist');

% Create colorbar
colorbar('peer',axes1,...
    [0.893453424716126 0.158816897146706 0.0385120180484526 0.514313296759111],...
    'FontSize',16,...
    'FontName','Times New Roman');

% Create axes
axes3 = axes('Parent',figure1,'YTickLabel',{'','20','40','60',''},...
    'YTick',[0 20 40 60 70],...
    'YGrid','on',...
    'XTickLabel',{'','','','','',''},...
    'XGrid','on',...
    'Position',[0.0982721382289417 0.682704811443433 0.583153347732181 0.204161248374512],...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'Color',[0.894117653369904 0.941176474094391 0.901960790157318]);
% Uncomment the following line to preserve the X-limits of the axes
xlim(axes3,[1 33]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes3,[0 70]);
box(axes3,'on');
hold(axes3,'all');

% Create plot
plot(detachingLengthTime1,'Parent',axes3,...
    'MarkerFaceColor',[0.729411780834198 0.831372559070587 0.95686274766922],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','detachingLengthTime');

% Create plot
plot(xx2,splineDetachingLengthTime1,'Parent',axes3,'LineWidth',2,...
    'Color',[1 0 0],...
    'DisplayName','splineDetachingLengthTime vs xx1');

% Create textbox
annotation(figure1,'textbox',...
    [0.450981586163142 0.767432060186765 0.227762803234501 0.0607553366174056],...
    'String',{'Average Length'},...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.738713301857686 0.694020218422645 0.183288409703504 0.0607553366174056],...
    'String',{'Distribution'},...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'LineStyle','none');
end
function createSelcetAttachingfigure(YMatrix1, xx1, YMatrix2)
%CREATEFIGURE(YMATRIX1,XX1,YMATRIX2)
%  YMATRIX1:  matrix of y data
%  XX1:  vector of x data
%  YMATRIX2:  matrix of y data

%  Auto-generated by MATLAB on 23-Oct-2010 19:14:01

% Create figure
figure1 = figure;

% Create subplot
subplot1 = subplot(1,1,1,'Parent',figure1,'YGrid','on','XGrid','on',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'Color',[0.894117653369904 0.941176474094391 0.901960790157318]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(subplot1,[0 3]);
box(subplot1,'on');
hold(subplot1,'all');

% Create xlabel
xlabel('Length [pixels]','FontSize',24,'FontName','Times New Roman');

% Create multiple lines using matrix input to plot
plot1 = plot(YMatrix1,'Parent',subplot1,'Marker','o','LineStyle','none');
set(plot1(1),'DisplayName','detachingLengthHist');
set(plot1(2),'DisplayName','attachingLengthHist');
set(plot1(3),'MarkerSize',8,'DisplayName','selectAttachingLength');

% Create multiple lines using matrix input to plot
plot2 = plot(xx1,YMatrix2,'Parent',subplot1,'LineWidth',2);
set(plot2(1),'DisplayName','Detaching');
set(plot2(2),'DisplayName','Attaching');
set(plot2(3),'DisplayName','Attaching/Detaching');

% Create legend
legend1 = legend(subplot1,'show');
set(legend1,...
    'Position',[0.280607685433422 0.669712070874863 0.297587131367292 0.243632336655592],...
    'FontSize',14,...
    'Color',[1 1 1]);
end
function createDurationfigure(X1, Y1, Y2)
%CREATEFIGURE(X1,Y1,Y2)
%  X1:  vector of x data
%  Y1:  vector of y data
%  Y2:  vector of y data

%  Auto-generated by MATLAB on 25-Oct-2010 18:54:53

% Create figure
figure1 = figure('Color',[1 1 1]);

% Create subplot
subplot1 = subplot(2,1,1,'Parent',figure1,'YScale','log','YMinorTick','on',...
    'YMinorGrid','on',...
    'YGrid','on',...
    'XTickLabel',{'0.08','0.8','8','80','800'},...
    'XScale','log',...
    'XMinorTick','on',...
    'XMinorGrid','on',...
    'XGrid','on',...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.945098042488098 0.968627452850342 0.949019610881805]);
box(subplot1,'on');
hold(subplot1,'all');

% Create ylabel
ylabel('Count per Frame','FontSize',20,'FontName','Times New Roman');

% Create loglog
loglog(X1,Y1,'Parent',subplot1,...
    'MarkerFaceColor',[0.854901969432831 0.701960802078247 1],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','resultDAevent.duration.count(:,2) vs resultDAevent.duration.count(:,1)');

% Create subplot
subplot2 = subplot(2,1,2,'Parent',figure1,...
    'YTickLabel',{'0','','20','','40','','60',''},...
    'YGrid','on',...
    'XTickLabel',{'0.08','0.8','8','80','800'},...
    'XScale','log',...
    'XMinorTick','on',...
    'XMinorGrid','on',...
    'XGrid','on',...
    'FontSize',14,...
    'FontName','Times New Roman',...
    'Color',[0.945098042488098 0.968627452850342 0.949019610881805]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(subplot2,[0 70]);
box(subplot2,'on');
hold(subplot2,'all');

% Create xlabel
xlabel('Duration Time [min]','FontSize',20,'FontName','Times New Roman');

% Create ylabel
ylabel('Length [pixels]','FontSize',20,'FontName','Times New Roman');

% Create semilogx
semilogx(X1,Y2,'Parent',subplot2,...
    'MarkerFaceColor',[0.854901969432831 0.701960802078247 1],...
    'MarkerSize',8,...
    'Marker','o',...
    'LineStyle','none',...
    'DisplayName','resultDAevent.duration.length(:,2) vs resultDAevent.duration.length(:,1)');

% Create line
annotation(figure1,'line',[0.136181575433912 0.857142857142857],...
    [0.868109947643979 0.660994764397906],'LineWidth',2,'Color',[1 0 1]);

end
function plotCorrelationResult(lengthCor,timeCor)
distBin1=lengthCor(:,1);
distData1=lengthCor(:,2);
distData2=lengthCor(:,3);
distData3=lengthCor(:,4);
distData4=lengthCor(:,5);
distData5=lengthCor(:,6);
xx = 0:.5:max(distBin1);
splineData1 = spline(distBin1,distData1,xx);
splineData2 = spline(distBin1,distData2,xx);
splineData3 = spline(distBin1,distData3,xx);
splineData4 = spline(distBin1,distData4,xx);
splineData5 = spline(distBin1,distData5,xx);
creatSpatialCorrelationfigure(distBin1, distData1, xx, splineData1, distData2, splineData2, distData3, splineData3, distData4, splineData4, distData5, splineData5)
distBin1=timeCor(:,1);
distData1=timeCor(:,2);
distData2=timeCor(:,3);
distData3=timeCor(:,4);
distData4=timeCor(:,5);
distData5=timeCor(:,6);
xx = 0:.5:max(distBin1);
splineData1 = spline(distBin1,distData1,xx);
splineData2 = spline(distBin1,distData2,xx);
splineData3 = spline(distBin1,distData3,xx);
splineData4 = spline(distBin1,distData4,xx);
splineData5 = spline(distBin1,distData5,xx);
 createTimeCorrelationfigure(distBin1, distData1, xx, splineData1, distData2, splineData2, distData3, splineData3, distData4, splineData4, distData5, splineData5)
end
function createSurriveTimefigure(resultDAevent1, YMatrix1)
%CREATEFIGURE(RESULTDAEVENT1,YMATRIX1)
%  RESULTDAEVENT1:  vector of x data
%  YMATRIX1:  matrix of y data

%  Auto-generated by MATLAB on 15-Mar-2011 21:44:06

% Create figure
figure1 = figure;

% Create axes
axes1 = axes('Parent',figure1,'YScale','log','YMinorTick','on',...
    'YMinorGrid','on',...
    'YGrid','on',...
    'XTickLabel',{'5','50','500','5000','50000'},...
    'XScale','log',...
    'XMinorTick','on',...
    'XMinorGrid','on',...
    'XGrid','on',...
    'Position',[0.13 0.117353308364544 0.753034773445732 0.845146691635455],...
    'FontSize',14,...
    'Color',[1 0.968627452850342 0.921568632125854]);
box(axes1,'on');
hold(axes1,'all');

% Create xlabel
xlabel('Survive time [s]','FontSize',16);

% Create ylabel
ylabel('Count','FontSize',16);

% Create multiple lines using matrix input to loglog
loglog1 = loglog(resultDAevent1,YMatrix1,'Parent',axes1);
set(loglog1(1),...
    'DisplayName','resultDAevent.type0.detachingSurrive(:,2) vs resultDAevent.type0.detachingSurrive(:,1)');
set(loglog1(2),'Marker','o',...
    'DisplayName','resultDAevent.type0.attachingSurrive(:,2) vs resultDAevent.type0.attachingSurrive(:,1)');
set(loglog1(3),'Marker','v',...
    'DisplayName','resultDAevent.type1.attachingSurrive(:,2) vs resultDAevent.type1.attachingSurrive(:,1)');
set(loglog1(4),'Marker','square',...
    'DisplayName','resultDAevent.type1.detachingSurrive(:,2) vs resultDAevent.type1.detachingSurrive(:,1)');

% Create textbox
annotation(figure1,'textbox',...
    [0.240252897787144 0.47840074906367 0.206533192834563 0.0549313358302122],...
    'String',{'Simple Event'},...
    'FontSize',20,...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.466786090621704 0.836677902621723 0.163329820864067 0.0549313358302122],...
    'String',{'From root'},...
    'FontSize',20,...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.46676501580611 0.6319088639201 0.159114857744995 0.0549313358302122],...
    'String',{'From leaf'},...
    'FontSize',20,...
    'EdgeColor','none');
end


